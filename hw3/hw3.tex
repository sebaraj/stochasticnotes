\documentclass{article}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{enumitem}
\usepackage{xcolor}
\usepackage{parskip}


\usepackage[a4paper, margin=1in]{geometry}

\title{S\&DS 351: Stochastic Processes - Homework 3}
\author{Bryan SebaRaj \\[0.8em] Professor Ilias Zadik}
\date{February 7, 2025}

\begin{document}

\maketitle

\subsection*{Problem 1} (10 points) Is it possible for a transient state to be periodic? If so, construct an example of such a Markov chain; otherwise, give a mathematical proof why not.

\textcolor{blue}{Note: I (fortunately) solved this after proving problem 3, so for a more thorough proof on how this example is transient, please see Problem 3. \\ \\ 
Yes, it is possible for a transient state to be periodic. Consider a 1-dimensional asymmetric random walk on $\mathbb{Z}$:
\[
   X_{n} \;=\; X_{n-1} \;+\; Z_n,
   \quad\text{where}\quad
   \mathbb{P}(Z_n = +1) \;=\; p
   \quad\text{and}\quad
   \mathbb{P}(Z_n = -1) \;=\; 1 - p,
\]
for some $p \in (0,1)$ with $p \neq \tfrac{1}{2}$. Starting at state 0, state 0 is transient (see Problem 3). \\ \\ 
% We claim that in this Markov chain:
% \begin{enumerate}
%   \item \emph{State 0 is transient} whenever $p \neq \tfrac{1}{2}.$
%   \item \emph{State 0 has period 2}, regardless of $p$ (as long as $p>0$ and $1-p>0$).
% \end{enumerate}
\smallskip
\noindent
Define the period as $d_i = \text{gcd}\{n:P^n(i,i)>0\}$, where $P$ is the transition matrix. \\
In the random walk, the walk must trivially take as many $+1$ steps as $-1$ steps to reach the initial state. Thus one can only return to state $x$ starting from $x$ in an even number of steps. Note that this holds for all integers. Hence for each integer $x$, 
\[
  (P^n)(x,x) \;>\;0 
  \quad\Longrightarrow\quad 
  n \ \text{is even}.
\]
\[
  (P^n)(x,x) \;=\;0 
  \quad\Longrightarrow\quad 
  n \ \text{is odd}.
\]
Therefore, the greatest common divisor of all such $n$ is $2$, and every state $x\in\mathbb{Z}$ has period~$2$.
}
   
\subsection*{Problem 2} Let $X_0, X_1, \dots$ be a Markov chain with transition matrix $P$. Let $k \geq 1$ be an integer.
    \begin{enumerate}
        \item (5 points) Prove that $Y_n = X_{kn}$ is also a Markov chain. Find its transition matrix.

            \textcolor{blue}{}

        
        \item (10 points) Suppose that the original chain $\{X_n\}$ is irreducible. Is $\{Y_n\}$ irreducible? If so, prove it; if not, provide a counterexample.

            \textcolor{blue}{}

        
        \item (10 points) Suppose that the original chain $\{X_n\}$ is aperiodic. Is $\{Y_n\}$ aperiodic? If so, prove it; if not, provide a counterexample.

            \textcolor{blue}{}
        
        \item (10 points) Suppose that the original chain $\{X_n\}$ is transient. Is $\{Y_n\}$ transient? If so, prove it; if not, provide a counterexample.

            \textcolor{blue}{}

        
        \item (15 points) Suppose that the original chain $\{X_n\}$ is recurrent. Is $\{Y_n\}$ recurrent? If so, prove it; if not, provide a counterexample.

            \textcolor{blue}{}

        
        \item (5 points) Suppose that the original chain $X_n$ is irreducible and that it has period $d$. What is the period of each state $i$ in the new Markov chain $Y_n$ for $k = d$?

           \textcolor{blue}{}

    \end{enumerate}

\subsection*{Problem 3} (Asymmetric random walk, 15 points) Consider the \textit{asymmetric} random walk on $\mathbb{Z}$, that is, $X_n = X_{n-1} + Z_n$, where $Z_1, Z_2, \dots$ are iid and $\mathbb{P}(Z_n = +1) = p$ and $\mathbb{P}(Z_n = -1) = 1 - p$, with $p \in [0,1]$ and $p \neq \frac{1}{2}$. Show that the state 0 is a transient state.

    In Lecture 7 we saw/will see that when $p = \frac{1}{2}$ this is not true anymore and the state 0 is recurrent. Can you explain intuitively why this is the case?

    \textit{Hint:} You may want to use Stirlingâ€™s formula that $\lim_{n \to \infty} \frac{n!}{(n/e)^n \sqrt{2\pi n}} = 1$.


    \textcolor{blue}{
Starting from \(X_0 = 0\), the random walk is at state \(0\) again at \(t=n\) only when it has taken an equal number of \(+1\) steps as \(-1\) steps. As such, \(n\) must be even. \\ \\ Suppose \(n = 2k\), and \(k\) is the number of \(Z_i\) that are \(+1\),
\[
  \mathbb{P}(X_{2k} = 0 \,\big\vert\, X_0 = 0)
  \;=\;
  \binom{2k}{k}\, p^k\, (1-p)^k
\]
\[
    \text{Note that }\mathbb{P}(X_n = 0 \,\big\vert\, X_0 = 0) \;=\; 0
  \ \ \text{if $n$ is odd}
\]
Hence the series of return probabilities at \(0\) is
\[
  \sum_{n=0}^\infty \mathbb{P}(X_n = 0 \,\big\vert\, X_0 = 0)
  \;=\;
  1 \;+\; \sum_{k=1}^\infty \binom{2k}{k}\, p^k\, (1-p)^k,
\]
accounting for the initial state of 0. \\ Using Stirling's approximation,
\medskip
\noindent
\[
  n! \;\sim\; \Bigl(\tfrac{n}{e}\Bigr)^{n}\sqrt{2\pi n}
  \quad\text{as }n \to \infty,
\]
applying to this case,
\[
  \binom{2k}{k}
  \;=\;
  \frac{(2k)!}{k!\,k!}
  \;\approx\;
  \frac{\sqrt{4\pi k}\,\bigl(\tfrac{2k}{e}\bigr)^{2k}}{\,2\pi k\,\bigl(\tfrac{k}{e}\bigr)^{k}\bigl(\tfrac{k}{e}\bigr)^{k}}
  \;=\;
  \frac{4^k}{\sqrt{\pi k}}
\]
Therefore,
\[
  \binom{2k}{k}\,p^k\,(1-p)^k
  \;\approx\;
  \frac{4^k}{\sqrt{\pi k}} \,\bigl[p(1-p)\bigr]^k
  \;=\;
  \frac{\bigl[4\,p(1-p)\bigr]^k}{\sqrt{\pi k}}.
\]
\medskip
\noindent
If $p \neq \frac{1}{2}$, then \(4\,p(1-p) < 1\) (If $f(x)=x(1-x)$, then $f'(x)=-x+1-x=-2x+1$. Solving for the max when $f'(x)=0, x=\frac{1}{2}$). \\ \\ 
Note, that as \(k \to \infty\), \(\bigl[4\,p(1-p)\bigr]^k\) decays exponentially. Therefore,
\[
  \binom{2k}{k}\,p^k\,(1-p)^k
  \;=\;
  O\!\Bigl(\bigl[4\,p(1-p)\bigr]^k\Bigr)
  \quad
  \text{and}
  \quad
  \sum_{k=1}^{\infty} \binom{2k}{k}\,p^k\,(1-p)^k
  \;<\;\infty.
\]
Thus,
\[
  \sum_{n=0}^\infty \mathbb{P}(X_n = 0 \,\big\vert\, X_0 = 0)
  \;=\;
  1 \;+\;
  \sum_{k=1}^{\infty}
  \binom{2k}{k}\, p^k\,(1-p)^k
  \;<\;
  \infty.
\]
which defines a transient state. \\ \\ 
\medskip
\noindent
However, when \(p = \frac{1}{2}\),
\[
  \binom{2k}{k}\,\Bigl(\frac12\Bigr)^k\,\Bigl(\frac12\Bigr)^k
  \;\approx\;
    \frac{\bigl[4\cdot 0.5(1-0.5)\bigr]^k}{\sqrt{\pi k}}
  \;=\;
  \frac{1}{\sqrt{\pi k}},
\]
so
\[
  \sum_{k=1}^\infty \frac{1}{\sqrt{k}}
  \;=\;
  \infty.
\]
which defines a recurrent state when $p=\frac12$. }

    \subsection*{Exercise 1.8} Consider a Markov chain on the integers with
\[
P(i, i+1) = 0.4 \text{ and } P(i, i-1) = 0.6 \text{ for } i > 0,
\]
\[
P(i, i+1) = 0.6 \text{ and } P(i, i-1) = 0.4 \text{ for } i < 0,
\]
\[
P(0,1) = P(0,-1) = \frac{1}{2}.
\]

This is a chain with infinitely many states, but it has a sort of probabilistic ``restoring force'' that always pushes back toward 0. Find the stationary distribution.

\textcolor{blue}{From the ``resisting force'' there is a single stationary distribution, expected to be symmetric around $0$, with a geometric decay away from $0$.
\medskip
\textbf{Step 2. Stationarity equations and ratio method.}
Denote the stationary distribution by $\{\pi_i\}_{i\in\mathbb{Z}}$, satisfying
\[
\sum_{j \in \mathbb{Z}} \pi_j P(j,i) \;=\; \pi_i
\quad \text{for all } i \in \mathbb{Z},
\]
and $\sum_{i \in \mathbb{Z}} \pi_i = 1$.
Because this is a (two-sided) birth-death type chain, one may use the standard balance equations:
\[
\pi_i \, P(i, i+1) \;=\; \pi_{i+1} \, P(i+1, i).
\]
Concretely, for $i \ge 1$:
\[
\pi_i \times 0.4 \;=\; \pi_{i+1} \times 0.6
\quad \Longrightarrow \quad 
\frac{\pi_{i+1}}{\pi_i} = \frac{0.4}{0.6} = \frac{2}{3}.
\]
For $i \le -1$:
\[
\pi_i \times 0.6 \;=\; \pi_{i+1} \times 0.4
\quad \Longrightarrow \quad 
\frac{\pi_{i+1}}{\pi_i} = \frac{0.6}{0.4} = \frac{3}{2}.
\]
We also need to handle the special transitions at $i=0$. The balance equation between $0$ and $1$ yields:
\[
\pi_0 \times 0.5 \;=\; \pi_1 \times 0.6
\quad \Longrightarrow \quad
\frac{\pi_1}{\pi_0} = \frac{0.5}{0.6} = \frac{5}{6}.
\]
And for $i=-1$:
\[
\pi_{-1} \times 0.6 = \pi_0 \times 0.5
\quad \Longrightarrow \quad 
\frac{\pi_{-1}}{\pi_{0}} = \frac{0.5}{0.6} = \frac{5}{6},
\]
Hence,
\[
\pi_1 = \frac{5}{6}\,\pi_0, 
\quad
\pi_{-1} = \frac{5}{6}\,\pi_0.
\]
This shows the symmetry $\pi_1 = \pi_{-1}$ indeed.  
\medskip
\noindent
\emph{(a) For \, $i>0$:}
\[
\frac{\pi_{i+1}}{\pi_i} = \frac{2}{3} 
\quad\Longrightarrow\quad 
\pi_i = \left(\frac{2}{3}\right)^{\,i-1} \,\pi_1
\quad \text{for } i \ge 1.
\]
But $\pi_1 = \frac{5}{6}\,\pi_0$, so 
\[
\pi_i 
\;=\; 
\left(\frac{2}{3}\right)^{\,i-1} \cdot \frac{5}{6}\,\pi_0
\quad \text{for } i \ge 1.
\]
\emph{(b) For \, $i<0$:}
\[
\frac{\pi_{i+1}}{\pi_i} = \frac{3}{2} 
\quad\Longrightarrow\quad
\pi_{i} = \frac{2}{3}\,\pi_{\,i+1}
\quad \text{for } i\le -2,
\]
stepping upward until $i=-1$, for which we already have
$\pi_{-1} = \tfrac{5}{6}\,\pi_0$. Iterating gives
\[
\pi_{-2} 
\;=\; 
\frac{2}{3}\,\pi_{-1}
\;=\;
\frac{2}{3} \cdot \frac{5}{6}\,\pi_0 
\;=\; 
\frac{5}{9}\,\pi_0,
\]
\[
\pi_{-3} 
\;=\; 
\frac{2}{3}\,\pi_{-2}
\;=\; 
\frac{2}{3}\cdot \frac{5}{9}\,\pi_0 
\;=\; 
\frac{10}{27}\,\pi_0,
\]
and so on. In fact, a direct pattern emerges, and for $i<0$,
\[
\pi_i 
\;=\;
\frac{5}{6}\,\left(\frac{2}{3}\right)^{\,|i|-1}\,\pi_0.
\]
\medskip
\textbf{Step 3. A unified formula.}
To summarize, set $|0|-1 = -1$ in the exponents interpreted carefully, or write piecewise.  A concise way is:
\[
\pi_0 = \pi_0,
\quad
\pi_i 
\;=\;
\frac{5}{6} \,\biggl(\frac{2}{3}\biggr)^{|i|-1}\,\pi_0 
\quad
\text{for } i \neq 0.
\]
We still must determine the constant $\pi_0$ by requiring
\[
\sum_{i=-\infty}^{\infty} \pi_i \;=\; 1.
\]
Hence
\[
\pi_0 
\;+\;
\sum_{i\neq 0} \frac{5}{6} \,\biggl(\tfrac{2}{3}\biggr)^{|i|-1}\,\pi_0
\;=\; 1.
\]
Factor out $\pi_0$:
\[
\pi_0 
\biggl[
1 
\;+\; 
\frac{5}{6}\sum_{i\neq 0}\bigl(\tfrac{2}{3}\bigr)^{|i|-1}
\biggr]
\;=\; 1.
\]
Next we split the sum at $i>0$ and $i<0$, noticing the symmetry:
\[
\sum_{i\neq 0}\bigl(\tfrac{2}{3}\bigr)^{|i|-1} 
\;=\;
2 \sum_{j=1}^{\infty} \bigl(\tfrac{2}{3}\bigr)^{j-1}
\;=\;
2 \sum_{k=0}^{\infty} \bigl(\tfrac{2}{3}\bigr)^{k}
\;=\;
2 \cdot \frac{1}{1 - \tfrac{2}{3}}
\;=\;
2 \cdot 3
\;=\;
6.
\]
Thus
\[
\frac{5}{6} \cdot 6
\;=\;
5,
\]
and so
\[
\pi_0 \Bigl[\,1 + 5\,\Bigr] 
\;=\;
6\,\pi_0
\;=\;
1 
\quad\Longrightarrow\quad
\pi_0 
\;=\; 
\frac{1}{6}.
\]
Therefore,
\[
\pi_0 = \frac{1}{6},
\quad
\pi_i 
\;=\;
\frac{5}{6}\,\biggl(\frac{2}{3}\biggr)^{|i|-1}\,\frac{1}{6}
\;=\;
\frac{5}{36}\,\biggl(\frac{2}{3}\biggr)^{|i|-1},
\ \ i \neq 0.
\]
Rewriting compactly,
\[
\pi_i
=
\begin{cases}
\displaystyle \frac{1}{6}, 
& i=0,\\[6pt]
\displaystyle \frac{5}{36}\,\bigl(\tfrac{2}{3}\bigr)^{|i|-1},
& i \neq 0.
\end{cases}
\]
}


\subsection*{Exercise 1.16} Show that if an irreducible Markov chain has a state $i$ such that $P(i, i) > 0$, then the chain
is aperiodic. Also show by example that this sufficient condition is not necessary.

\textcolor{blue}{
Let $\{X_n\}$ be an irreducible Markov chain on a countable state space $S$. Suppose there is a state $i \in S$ such that
\[
    P(i,i) > 0.
\]
The period of state $i$ is defined as
\[
    d(i) \;=\; \gcd \{ n \ge 1 : P^n(i,i) > 0 \},
\]
Since $P(i,i) = P^1(i,i)> 0$, there is a positive probability of returning to $i$ in exactly 1 step. As such, $1 \in \{n: P^n(i,i) > 0\}$, so any common divisor of all $n$ must trivially divide 1. \\ \\ Therefore,
\[
    d(i) \;=\; \gcd \{ n \ge 1 : P^n(i,i) > 0 \} \;=\; 1.
\]
Thus, $i$ is an aperiodic state. \\ \\ 
By irreducibility, for any other state $j \in S$, there exist integers $m,k \ge 1$ such that $P^m(j,i) > 0$ and $P^k(i,j) > 0$. Then for any $n \ge 1$,
\[
    P^{m+n+k}(j,j) 
    \;\ge\; P^m(j,i) \, P^n(i,i) \, P^k(i,j).
\]
Since $P^n(i,i) > 0$ for all $n \ge 1$ (as argued above, using the self-loop at $i$ repeatedly if necessary), we conclude that for arbitrarily many $n$, the probability $P^{m+n+k}(j,j)$ is strictly positive. It follows that
\[
    d(j) \;=\; \gcd\{ n \ge 1 : P^n(j,j) > 0 \} \;=\; 1.
\]
Hence \emph{every} state in an irreducible chain with a self-loop ($P(i,i) > 0$ for some $i$) has period 1, which means the chain is aperiodic.
\bigskip
We now show that having $P(i,i) > 0$ for some state $i$ is \emph{not} a necessary condition for aperiodicity by giving a simple Markov chain that is irreducible, aperiodic, and yet has no self-loops (i.e.\ $P(i,i)=0$ for all $i$).
Consider a chain on three states $\{1,2,3\}$ with transition matrix:
\[
    P \;=\; \begin{pmatrix}
    0 & 1 & 0 \\[6pt]
    \tfrac{1}{2} & 0 & \tfrac{1}{2} \\[6pt]
    \tfrac{1}{2} & \tfrac{1}{2} & 0
    \end{pmatrix}.
\]
Explicitly:
\[
    P(1,1)=0, \quad P(1,2)=1, \quad P(1,3)=0, 
\]
\[
    P(2,1)=\tfrac{1}{2}, \quad P(2,2)=0, \quad P(2,3)=\tfrac{1}{2},
\]
\[
    P(3,1)=\tfrac{1}{2}, \quad P(3,2)=\tfrac{1}{2}, \quad P(3,3)=0.
\]
Observe that:
\begin{itemize}
    \item The chain is \emph{irreducible} because each state communicates with all others (e.g.\ from $1$ you can reach $2$, then $3$, and back to $1$, etc.).
    \item There are \emph{no self-loops}: $P(i,i)=0$ for $i=1,2,3$.
\end{itemize}
To see that state $1$ is aperiodic, note:
\[
    P^2(1,1) = P(1,2)P(2,1) = (1)\left(\tfrac{1}{2}\right) = \tfrac{1}{2} > 0,
\]
and
\[
    P^3(1,1) = P(1,2)P(2,3)P(3,1) = 1 \cdot \tfrac{1}{2} \cdot \tfrac{1}{2}
    = \tfrac{1}{4} > 0.
\]
Hence $1$ can return to itself in both $2$ steps and $3$ steps, so the set of possible return times to $1$ contains $\{2,3\}$. The greatest common divisor of $2$ and $3$ is $1$, which implies the period of $1$ is $1$. By irreducibility, every other state also has period $1$, making the entire chain aperiodic.
This example proves that $P(i,i) > 0$ for some $i$ is not a necessary condition for a chain to be aperiodic.
}


\end{document}

